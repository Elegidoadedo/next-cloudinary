import dr,{useState as mr}from"react";import hr from"next/image";var Tt=/\/v\d+\//,At=/https?:\/\/(?<host>[^\/]+)\/(?<cloudName>[^\/]+)\/(?<assetType>image|images|video|videos|raw|files)\/(?<deliveryType>upload|fetch|private|authenticated|sprite|facebook|twitter|youtube|vimeo)?\/?(?<signature>s\-\-[a-zA-Z0-9]+\-\-)?\/?(?<transformations>(?:[^_\/]+_[^,\/]+,?\/?)*\/)*(?<version>v\d+|\w{1,2})\/(?<publicId>[^\.^\s]+)(?<format>\.[a-zA-Z0-9]+$)?$/,Pt=["images","videos","files"];function ge(t){var e,r,i,o;if(typeof t!="string")throw new Error(`Failed to parse URL: Invalid src of type ${typeof t}`);if(!Tt.test(t))throw new Error("Invalid src: Does not include version (Ex: /v1234/)");let[n,l]=t.split("?"),s=n.match(At),f=(r=(e=s==null?void 0:s.groups)==null?void 0:e.transformations)==null?void 0:r.split("/").filter(c=>!!c),d={...s==null?void 0:s.groups,seoSuffix:void 0,transformations:f||[],queryParams:{},version:(i=s==null?void 0:s.groups)!=null&&i.version?parseInt(s.groups.version.replace("v","")):void 0};if(l&&(d.queryParams=l.split("&").reduce((c,I)=>{let[_,S]=I.split("=");return c[_]=S,c},{})),d.assetType&&Pt.includes(d.assetType)){let c=((o=d.publicId)==null?void 0:o.split("/"))||[];d.seoSuffix=c.pop(),d.publicId=c.join("/")}return d}function Le(t){let{transformations:e=[]}=ge(t)||{};return e.map(r=>r.split(","))}function Ue(t){if(typeof btoa=="function")return btoa(t);if(typeof Buffer!="undefined")return Buffer.from(t).toString("base64")}function b(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $e(t=[],e,r="asc"){function i(a,n){let l=a[e],s=n[e];return typeof l=="string"&&(l=l.toLowerCase()),typeof s=="string"&&(s=s.toLowerCase()),l<s?-1:l>s?1:0}let o=[...t];return typeof e!="string"?o:(o=o.sort(i),r==="desc"?o.reverse():o)}function It(t){return!(typeof t!="object"||t instanceof Array)}var ye=class{filterOutNonSupportedKeys(e,r){let i=Object.create({});return It(e)?(Object.keys(e).forEach(o=>{r.indexOf(o)>=0?i[o]=e[o]:console.warn("Warning - unsupported key provided to configuration: ",o)}),i):Object.create({})}},qe=ye;var _e=["cname","secureDistribution","privateCdn","signUrl","longUrlSignature","shorten","useRootPath","secure","forceVersion","analytics"];var H=class extends qe{constructor(e){super();let r=this.filterOutNonSupportedKeys(e,_e);Object.assign(this,{secure:!0},r)}extend(e){let r=this.filterOutNonSupportedKeys(e,_e);return new H(Object.assign({},this,r))}setCname(e){return this.cname=e,this}setSecureDistribution(e){return this.secureDistribution=e,this}setPrivateCdn(e){return this.privateCdn=e,this}setSignUrl(e){return this.signUrl=e,this}setLongUrlSignature(e){return this.longUrlSignature=e,this}setShorten(e){return this.shorten=e,this}setUseRootPath(e){return this.useRootPath=e,this}setSecure(e){return this.secure=e,this}setForceVersion(e){return this.forceVersion=e,this}},De=H;var A=class{constructor(e){this.values=[],this.delimiter=":",this.hasValue(e)&&this.addValue(e)}toString(){return this.values.join(this.delimiter)}hasValue(e){return typeof e!="undefined"&&e!==null&&e!==""}addValue(e){return Array.isArray(e)?this.values=this.values.concat(e):this.values.push(e),this.values=this.values.filter(r=>this.hasValue(r)),this}setDelimiter(e){return this.delimiter=e,this}};var ve=class extends Error{constructor(e="Unsupported"){super(e)}};function k(t){return new ve(t)}function Re(){return this._qualifierModel||{error:k(`unsupported qualifier ${this.constructor.name}`)}}var J=class{constructor(){this._qualifierModel={}}toJson(){return Re.apply(this)}};var U=class extends J{constructor(e,r){super(),this.delimiter="_",this.key=e,r instanceof A?this.qualifierValue=r:(this.qualifierValue=new A,this.qualifierValue.addValue(r))}toString(){let{key:e,delimiter:r,qualifierValue:i}=this;return`${e}${r}${i.toString()}`}addValue(e){return this.qualifierValue.addValue(e),this}};var C=class extends U{constructor(e,r){let i;r?i=new A([e,`${r}`]).setDelimiter(":"):i=e,super("fl",i),this.flagValue=r}toString(){return super.toString().replace(/\./,"%2E")}getFlagValue(){return this.flagValue}};function Ne(t,e){let r=Array.from(t.entries());return e.forEach(i=>{r.push(["fl",i])}),r.sort().map(i=>i[1])}function Ve(){return this._actionModel&&Object.keys(this._actionModel).length?this._actionModel:{error:k(`unsupported action ${this.constructor.name}`)}}var Z=class{constructor(){this._actionModel={}}toJson(){return Ve.apply(this)}};var q=class extends Z{constructor(){super(...arguments),this.qualifiers=new Map,this.flags=[],this.delimiter=",",this.actionTag=""}prepareQualifiers(){}getActionTag(){return this.actionTag}setActionTag(e){return this.actionTag=e,this}toString(){return this.prepareQualifiers(),Ne(this.qualifiers,this.flags).join(this.delimiter)}addQualifier(e){if(typeof e=="string"){let[r,i]=e.toLowerCase().split("_");r==="fl"?this.flags.push(new C(i)):this.qualifiers.set(r,new U(r,i))}else this.qualifiers.set(e.key,e);return this}addFlag(e){return typeof e=="string"?this.flags.push(new C(e)):e instanceof C&&this.flags.push(e),this}addValueToQualifier(e,r){return this.qualifiers.get(e).addValue(r),this}};var ee=class extends q{constructor(e){super(),this.addQualifier(new U("b",new A(e).setDelimiter("_")))}};function je(t){return t&&(t.match(/^#/)?`rgb:${t.substr(1)}`:t)}var K=class{constructor(e){this.raw=e}toString(){return this.raw}toJson(){return{error:k(`unsupported action ${this.constructor.name}`)}}};function Me(t){let e=t;return"error"in e&&!!e.error}function ke(){return new C("lossy")}function Fe(){return new C("preserve_transparency")}function ze(t){return new C("progressive",t)}var te=class extends A{constructor(e){super(e),this.val=e}getValue(){return this.val}};function D(t){let e={};return Object.keys(t).forEach(r=>{e[t[r]]=r}),e}var St={limitFit:"limit",limitFill:"lfill",minimumFit:"mfit",thumbnail:"thumb",limitPad:"lpad",minimumPad:"mpad"},Lt={colorSpace:"cs",dpr:"dpr",density:"dn",defaultImage:"d",format:"f",quality:"q"},Ut={redEye:"redeye",advancedRedEye:"adv_redeye",oilPaint:"oil_paint",unsharpMask:"unsharp_mask",makeTransparent:"make_transparent"},$t={autoBest:"auto:best",autoEco:"auto:eco",autoGood:"auto:good",autoLow:"auto:low",jpegminiHigh:"jpegmini:1",jpegminiMedium:"jpegmini:2",jpegminiBest:"jpegmini:0"},qt={fullHd:"full_hd",fullHdWifi:"full_hd_wifi",fullHdLean:"full_hd_lean",hdLean:"hd_lean"},Dt={444:"CHROMA_444",420:"CHROMA_420"},Rt={noCmyk:"no_cmyk",keepCmyk:"keep_cmyk",tinySrgb:"tinysrgb",srgbTrueColor:"srgb:truecolor"};var yi=D(Dt),_i=D(Rt),vi=D(St),We=D(Lt),xi=D(Ut),Ci=D($t),wi=D(qt);var re=class extends q{constructor(e,r,i){super(),this._actionModel={};let o;r instanceof te?o=r.getValue():o=r,this._actionModel.actionType=We[e],this._actionModel[i]=o,this.addQualifier(new U(e,r))}};var ie=class extends C{constructor(e){super("progressive",e)}};var R=class extends re{constructor(e,r){super(e,r,"formatType")}lossy(){return this._actionModel.lossy=!0,this.addFlag(ke()),this}progressive(e){return e instanceof ie?(this._actionModel.progressive={mode:e.getFlagValue()},this.addFlag(e)):(this._actionModel.progressive={mode:e},this.addFlag(ze(e))),this}preserveTransparency(){return this._actionModel.preserveTransparency=!0,this.addFlag(Fe()),this}static fromJson(e){let{formatType:r,lossy:i,progressive:o,preserveTransparency:a}=e,n;return r?n=new this("f",r):n=new this("f"),o&&(o.mode?n.progressive(o.mode):n.progressive()),i&&n.lossy(),a&&n.preserveTransparency(),n}};var N=class{constructor(){this.actions=[]}addAction(e){let r;if(typeof e=="string"){if(e.indexOf("/")>=0)throw"addAction cannot accept a string with a forward slash in it - /, use .addTransformation() instead";r=new K(e)}else r=e;return this.actions.push(r),this}addTransformation(e){return e instanceof N?this.actions=this.actions.concat(e.actions):this.actions.push(new K(e)),this}toString(){return this.actions.map(e=>e.toString()).filter(e=>e).join("/")}animated(e){return this.addAction(e)}border(e){return this.addAction(e)}reshape(e){return this.addAction(e)}resize(e){return this.addAction(e)}quality(e){return this.addAction(new R("q",e)),this}format(e){return this.addAction(new R("f",e)),this}roundCorners(e){return this.addAction(e)}overlay(e){return this.addAction(e)}underlay(e){return e.setLayerType("u"),this.addAction(e)}addVariable(e){return this.addAction(e)}conditional(e){return this.addAction(e)}effect(e){return this.addAction(e)}adjust(e){return this.addAction(e)}rotate(e){return this.addAction(e)}namedTransformation(e){return this.addAction(e)}delivery(e){return this.addAction(e)}backgroundColor(e){return this.addAction(new ee(je(e)))}psdTools(e){return this.addAction(e)}extract(e){return this.addAction(e)}addFlag(e){let r=new q,i=e;return typeof e=="string"&&(i=new C(e)),r.addQualifier(i),this.addAction(r)}customFunction(e){return this.addAction(e)}transcode(e){return this.addAction(e)}videoEdit(e){return this.addAction(e)}toJson(){let e=[];for(let r of this.actions){let i=r.toJson();if(Me(i))return i;e.push(i)}return{actions:e}}};var oe=class extends N{};var F=class extends N{};function Ye(t){return t.match(/^https?:\//)}function Be(t){return t.indexOf("/")<0}function He(t){return t.match(/^v[0-9]+/)}function Ke(t,e){let r=e.secure,i=e.privateCdn,o=e.cname,a=e.secureDistribution;return!r&&!o?`http://res.cloudinary.com/${t}`:r&&!a&&i?`https://${t}-res.cloudinary.com`:r&&!a?`https://res.cloudinary.com/${t}`:r&&a&&i?`https://${a}`:r&&a?`https://${a}/${t}`:!r&&o?`http://${o}/${t}`:"ERROR"}function Xe(t){return t||"image"}function Qe(t){return t||"upload"}function Ge(t,e,r){let i=r!==!1;return e?`v${e}`:He(t)||Ye(t)||Be(t)?"":i?"v1":""}function z(t,e,r){let i=e>>0,o=String(typeof r!="undefined"?r:" ");return t.length>i?String(t):(i=i-t.length,i>o.length&&(o+=Nt(o,i/o.length)),o.slice(0,i)+String(t))}function Nt(t,e){let r=e,i="";for(;r>0;)i+=t,r--;return i}var Vt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xe={},Je=0;Vt.split("").forEach(t=>{let e=Je.toString(2);e=z(e,6,"0"),xe[e]=t,Je++});function Ze(t){if(t.split(".").length<2)throw new Error("invalid semVer, must have at least two segments");return t.split(".").reverse().map(e=>{let r=+e;if(isNaN(r)||r<0)throw"Invalid version number provided";return z(e,2,"0")}).join(".")}function Ce(t){let e="",i=t.split(".").length*6,o=Ze(t),n=parseInt(o.split(".").join("")).toString(2);if(n=z(n,i,"0"),n.length%6!==0)throw"Version must be smaller than 43.21.26)";return n.match(/.{1,6}/g).forEach(l=>{e+=xe[l]}),e}function et(t){let e={sdkSemver:t.sdkSemver,techVersion:t.techVersion,sdkCode:t.sdkCode,feature:"0"};return t.accessibility&&(e.feature="D"),t.lazyload&&(e.feature="C"),t.responsive&&(e.feature="A"),t.placeholder&&(e.feature="B"),e}var tt="1.9.0";function jt(){let t="0.0.0";if(typeof window!="undefined")return t;try{return process.versions.node||t}catch(e){return t}}function Mt(t){let e={techVersion:jt(),sdkCode:"T",sdkSemver:tt.split("-")[0],responsive:!1,placeholder:!1,lazyload:!1,accessibility:!1};return t?Object.assign(Object.assign({},e),t):e}function rt(t){let e=Mt(t),r=et(e);try{let i=kt(r.techVersion),o=Ce(r.sdkSemver),a=Ce(i),n=r.feature;return`A${r.sdkCode}${o}${a}${n}`}catch(i){return"E"}}function kt(t){let e=t.split(".");return`${e[0]}.${e[1]}`}var it={"image/upload":"images","image/private":"private_images","image/authenticated":"authenticated_images","raw/upload":"files","video/upload":"videos"},ne=class{constructor(e,r={},i){this.setPublicID(e),this.setCloudConfig(r),this.setURLConfig(i)}setURLConfig(e){return this.urlConfig=new De(e),this}setCloudConfig(e){return this.cloudName=e.cloudName,this.apiKey=e.apiKey,this.apiSecret=e.apiSecret,this.authToken=e.authToken,this}setPublicID(e){return this.publicID=e?e.toString():"",this}setDeliveryType(e){return this.deliveryType=e,this}setSuffix(e){return this.suffix=e,this}setSignature(e){return this.signature=e,this}setVersion(e){return e&&(this.version=e),this}setAssetType(e){return e&&(this.assetType=e),this}sign(){return this}toURL(e={}){return this.createCloudinaryURL(null,e.trackedAnalytics)}validateAssetForURLCreation(){if(typeof this.cloudName=="undefined")throw"You must supply a cloudName when initializing the asset";let e=this.suffix&&this.suffix.indexOf(".")>=0,r=this.suffix&&this.suffix.indexOf("/")>=0;if(e||r)throw"`suffix`` should not include . or /"}getResourceType(){let e=Xe(this.assetType),r=Qe(this.deliveryType),i=!!this.suffix,o=`${e}/${r}`,a=it[`${e}/${r}`],n=this.urlConfig.useRootPath,l=this.urlConfig.shorten;if(n){if(o==="image/upload")return"";throw new Error(`useRootPath can only be used with assetType: 'image' and deliveryType: 'upload'. Provided: ${o} instead`)}if(l&&o==="image/upload")return"iu";if(i){if(a)return a;throw new Error(`URL Suffix only supported for ${Object.keys(it).join(", ")}, Provided: ${o} instead`)}return o}getSignature(){return this.signature?`s--${this.signature}--`:""}createCloudinaryURL(e,r){if(!this.publicID)return"";this.validateAssetForURLCreation();let i=Ke(this.cloudName,this.urlConfig),o=e?e.toString():"",a=Ge(this.publicID,this.version,this.urlConfig.forceVersion),n=this.publicID.replace(/,/g,"%2C"),l=[i,this.getResourceType(),this.getSignature(),o,a,n,this.suffix].filter(s=>s).join("/");if(typeof e=="string")return l;{let s=encodeURI(l).replace(/\?/g,"%3F").replace(/=/g,"%3D");return this.urlConfig.analytics!==!1&&!n.includes("?")?`${s}?_a=${rt(r)}`:s}}};var W=class extends ne{constructor(e,r,i,o){super(e,r,i),this.transformation=o}animated(e){return this.transformation.animated(e),this}border(e){return this.transformation.border(e),this}reshape(e){return this.transformation.reshape(e),this}resize(e){return this.transformation.resize(e),this}quality(e){return this.addAction(new R("q",e)),this}format(e){return this.addAction(new R("f",e)),this}roundCorners(e){return this.transformation.roundCorners(e),this}overlay(e){return this.transformation.overlay(e),this}addVariable(e){return this.transformation.addVariable(e),this}conditional(e){return this.transformation.conditional(e),this}effect(e){return this.transformation.effect(e),this}adjust(e){return this.transformation.adjust(e),this}rotate(e){return this.transformation.rotate(e),this}namedTransformation(e){return this.transformation.namedTransformation(e),this}delivery(e){return this.transformation.delivery(e),this}backgroundColor(e){return this.transformation.backgroundColor(e),this}psdTools(e){return this.transformation.psdTools(e),this}extract(e){return this.transformation.extract(e),this}addFlag(e){return this.transformation.addFlag(e),this}customFunction(e){return this.transformation.customFunction(e),this}addAction(e){return this.transformation.addAction(e),this}addTransformation(e){return this.transformation.addTransformation(e),this}toString(){return this.transformation.toString()}underlay(e){return this.transformation.underlay(e),this}toURL(e={}){return this.createCloudinaryURL(this.transformation,e==null?void 0:e.trackedAnalytics)}};var se=class extends W{constructor(e,r,i){super(e,r,i,new oe)}};var ae=class extends W{constructor(e,r,i){super(e,r,i,new F),this.assetType="video"}transcode(e){return this.transformation.transcode(e),this}videoEdit(e){return this.transformation.videoEdit(e),this}};var X=class{constructor(e){e&&(this.cloudinaryConfig=e)}image(e){return new se(e,this.cloudinaryConfig.cloud,this.cloudinaryConfig.url)}video(e){return new ae(e,this.cloudinaryConfig.cloud,this.cloudinaryConfig.url)}setConfig(e){return this.cloudinaryConfig=e,this}getConfig(){return this.cloudinaryConfig}extendConfig(){}};var Ft=Object.defineProperty,P=(t,e)=>{for(var r in e)Ft(t,r,{get:e[r],enumerable:!0})},st={};P(st,{plugin:()=>Wt,props:()=>zt});var we=["crop","fill","lfill","fill_pad","thumb"],ot=["crop","thumb"],zt=["crop","gravity","zoom"];function Wt(t){let{cldImage:e,options:r}=t,{width:i,height:o,widthResize:a,crop:n="limit"}=r,l={width:void 0},s="";return i&&(s=`c_${n},w_${i}`),!r.gravity&&we.includes(n)&&(r.gravity="auto"),["limit"].includes(n)||(s=`${s},h_${o}`),r.gravity&&(r.gravity==="auto"&&!we.includes(n)?console.warn(`Auto gravity can only be used with crop modes: ${we.join(", ")}. Not applying gravity.`):s=`${s},g_${r.gravity}`),r.zoom&&(r.zoom==="auto"&&!ot.includes(n)?console.warn(`Zoom can only be used with crop modes: ${ot.join(", ")}. Not applying zoom.`):s=`${s},z_${r.zoom}`),e.effect(s),i&&typeof a=="number"&&a<i&&(l.width=a),{options:l}}var at={};P(at,{plugin:()=>Bt,props:()=>Yt});var V={aspectRatio:{qualifier:"ar"},crop:{qualifier:"c"},gravity:{qualifier:"g"},height:{qualifier:"h"},width:{qualifier:"w"}},ue={angle:{qualifier:"a"},gravity:{qualifier:"g"},x:{qualifier:"x"},y:{qualifier:"y"}},Oe={alignment:{qualifier:!1,order:6},antialias:{qualifier:"antialias"},border:{qualifier:"bo",location:"primary"},color:{qualifier:"co",location:"primary"},fontFamily:{qualifier:!1,order:1},fontSize:{qualifier:!1,order:2},fontStyle:{qualifier:!1,order:4},fontWeight:{qualifier:!1,order:3},hinting:{qualifier:"hinting"},letterSpacing:{qualifier:"letter_spacing"},lineSpacing:{qualifier:"line_spacing"},stroke:{qualifier:"self",order:7},textDecoration:{qualifier:!1,order:5}},G={art:{prefix:"e",qualifier:"art"},autoBrightness:{prefix:"e",qualifier:"auto_brightness"},autoColor:{prefix:"e",qualifier:"auto_color"},autoContrast:{prefix:"e",qualifier:"auto_contrast"},assistColorblind:{prefix:"e",qualifier:"assist_colorblind"},background:{qualifier:"b"},blackwhite:{prefix:"e",qualifier:"blackwhite"},blur:{prefix:"e",qualifier:"blur"},blurFaces:{prefix:"e",qualifier:"blur_faces"},blurRegion:{prefix:"e",qualifier:"blur_region"},border:{qualifier:"bo"},brightness:{prefix:"e",qualifier:"brightness"},brightnessHSB:{prefix:"e",qualifier:"brightness_hsb"},cartoonify:{prefix:"e",qualifier:"cartoonify"},color:{qualifier:"co"},colorize:{prefix:"e",qualifier:"colorize"},contrast:{prefix:"e",qualifier:"contrast"},distort:{prefix:"e",qualifier:"distort"},fillLight:{prefix:"e",qualifier:"fill_light"},gamma:{prefix:"e",qualifier:"gamma"},gradientFade:{prefix:"e",qualifier:"gradient_fade"},grayscale:{prefix:"e",qualifier:"grayscale"},improve:{prefix:"e",qualifier:"improve"},multiply:{prefix:"e",qualifier:"multiply"},negate:{prefix:"e",qualifier:"negate"},oilPaint:{prefix:"e",qualifier:"oil_paint"},opacity:{qualifier:"o"},outline:{prefix:"e",qualifier:"outline"},overlay:{prefix:"e",qualifier:"overlay"},pixelate:{prefix:"e",qualifier:"pixelate"},pixelateFaces:{prefix:"e",qualifier:"pixelate_faces"},pixelateRegion:{prefix:"e",qualifier:"pixelate_region"},redeye:{prefix:"e",qualifier:"redeye"},replaceColor:{prefix:"e",qualifier:"replace_color"},saturation:{prefix:"e",qualifier:"saturation"},screen:{prefix:"e",qualifier:"screen"},sepia:{prefix:"e",qualifier:"sepia"},shadow:{prefix:"e",qualifier:"shadow"},sharpen:{prefix:"e",qualifier:"sharpen"},shear:{prefix:"e",qualifier:"shear"},simulateColorblind:{prefix:"e",qualifier:"simulate_colorblind"},tint:{prefix:"e",qualifier:"tint"},unsharpMask:{prefix:"e",qualifier:"unsharp_mask"},vectorize:{prefix:"e",qualifier:"vectorize"},vibrance:{prefix:"e",qualifier:"vibrance"},vignette:{prefix:"e",qualifier:"vignette"}},nt={relative:{prefix:"fl",qualifier:"relative",location:"primary"}};function Q({prefix:t,qualifier:e,value:r}){let i="";if(t&&(i=`${t}_`),r===!0||r==="true")return`${i}${e}`;if(typeof r=="string"||typeof r=="number")return t?`${i}${e}:${r}`:`${e}_${r}`}var Yt=[...Object.keys(G),"effects"];function Bt(t){let{cldImage:e,options:r}=t;o({effects:G,options:r}).filter(a=>!!a).forEach(a=>e.effect(a)),Array.isArray(r==null?void 0:r.effects)&&(r==null||r.effects.forEach(a=>{let n=o({effects:G,options:a}).filter(l=>!!l).join(",");e.effect(n)}));function o({effects:a,options:n}){return Object.keys(a).map(l=>{let{prefix:s,qualifier:f}=a[l];return Q({qualifier:f,prefix:s,value:n==null?void 0:n[l]})})}return{}}var lt={};P(lt,{plugin:()=>Kt,props:()=>Ht});var Ht=["sanitize"];function Kt(t){let{cldImage:e,options:r}=t,{sanitize:i=!0}=r;return i&&(r.format==="svg"||e.publicID.endsWith(".svg"))&&e.effect("fl_sanitize"),{}}var ut={};P(ut,{DEFAULT_TEXT_OPTIONS:()=>le,plugin:()=>Qt,props:()=>Xt});var Xt=["text","overlays"],le={color:"black",fontFamily:"Arial",fontSize:200,fontWeight:"bold"};function Qt(t){let{cldImage:e,options:r}=t,{text:i,overlays:o=[]}=r,a="overlay",n="l";Array.isArray(o)&&o.forEach(l),typeof i=="string"?l({text:{...le,text:i}}):typeof i=="object"&&l({text:{...le,...i}});function l({publicId:s,url:f,position:d,text:c,effects:I=[],appliedEffects:_=[],...S}){let x=typeof s=="string",E=typeof f=="string",w=typeof c=="object"||typeof c=="string",m=typeof d=="object";if(!x&&!E&&!w){console.warn(`An ${a} is missing Public ID, URL, or Text`);return}let u;w?u=`${n}_text`:x?u=`${n}_${s.replace(/\//g,":")}`:E&&(u=`${n}_fetch:${Ue(f)}`);let h=[],v=[];if(Object.keys(S).forEach(p=>{if(!b(V,p))return;let{qualifier:g}=V[p],O=Q({qualifier:g,value:S[p]});O&&h.push(O)}),I.forEach(p=>{Object.keys(p).forEach(g=>{let{qualifier:O,prefix:y}=V[g]||G[g]||{},T=Q({qualifier:O,prefix:y,value:p[g]});T&&h.push(T)})}),_.forEach(p=>{Object.keys(p).forEach(g=>{let{qualifier:O,prefix:y}=V[g]||G[g]||{},T=Q({qualifier:O,prefix:y,value:p[g]});T&&v.push(T)})}),w){typeof c=="string"&&(c={...le,text:c});let p=[];if(typeof c=="object"){let g=Object.keys(c).filter(y=>b(Oe,y)).map(y=>{let T=c&&b(c,y)&&c[y];return{...Oe[y],key:y,value:T,order:Oe[y].order||99}}),O=$e(g,"order");for(let y of O){let{key:T,value:Y,qualifier:M,location:L}=y;L==="primary"?h.push(`${M}_${Y}`):M==="self"?p.push(T):M?p.push(`${M}_${Y}`):p.push(Y)}}u=`${u}:${p.join("_")}:${c==null?void 0:c.text}`}m&&Object.keys(d).forEach(p=>{if(!b(ue,p))return;let{qualifier:g}=ue[p],O=Q({qualifier:g,value:d[p]});O&&v.push(O)}),h.length>0&&(u=`${u},${h.join(",")}`),u=`${u}/fl_layer_apply,fl_no_overflow`,v.length>0&&(u=`${u},${v.join(",")}`),e.addTransformation(u)}return{}}var ft={};P(ft,{plugin:()=>Jt,props:()=>Gt});var Gt=["transformations"];function Jt(t){let{cldImage:e,options:r}=t,{transformations:i=[]}=r;return Array.isArray(i)||(i=[i]),i.forEach(o=>{e.addTransformation(`t_${o}`)}),{}}var ct={};P(ct,{plugin:()=>er,props:()=>Zt});var Zt=["rawTransformations"];function er(t){let{cldImage:e,options:r}=t,{rawTransformations:i=[]}=r;return i.forEach(o=>{e.addTransformation(o)}),{}}var pt={};P(pt,{plugin:()=>rr,props:()=>tr});var tr=["removeBackground"];function rr(t){let{cldImage:e,options:r}=t,{removeBackground:i=!1}=r;return i&&e.effect("e_background_removal"),{}}var dt={};P(dt,{plugin:()=>or,props:()=>ir});var ir=["seoSuffix"];function or(t){let{cldImage:e,options:r}=t,{seoSuffix:i}=r;return typeof i=="string"&&e.setSuffix(i),{}}var mt={};P(mt,{plugin:()=>sr,props:()=>nr});var nr=["underlay","underlays"];function sr(t){let{cldImage:e,options:r}=t,{underlay:i,underlays:o=[]}=r,a="u";Array.isArray(o)&&o.forEach(n),typeof i=="string"&&n({publicId:i,crop:"fill",width:"1.0",height:"1.0",flags:["relative"]});function n({publicId:l,type:s,position:f,effects:d=[],flags:c=[],...I}){let _=typeof l=="string",S=typeof f=="object";if(!_){console.warn(`An ${s} is missing a Public ID`);return}let x=`${a}_${l.replace(/\//g,":")}`,E=[],w=[];Object.keys(I).forEach(m=>{if(!b(V,m))return;let{qualifier:u}=V[m];E.push(`${u}_${I[m]}`)}),d.forEach(m=>{Object.keys(m).forEach(u=>{if(!b(V,u))return;let{qualifier:h}=V[u];E.push(`${h}_${m[u]}`)})}),S&&Object.keys(f).forEach(m=>{if(!b(ue,m))return;let{qualifier:u}=ue[m];w.push(`${u}_${f[m]}`)}),c.forEach(m=>{if(!b(nt,m))return;let{qualifier:u,prefix:h}=nt[m];E.push(`${h}_${u}`)}),x=`${x},${E.join(",")}`,x=`${x}/fl_layer_apply,fl_no_overflow`,w.length>0&&(x=`${x},${w.join(",")}`),e.addTransformation(x)}return{}}var ht={};P(ht,{plugin:()=>lr,props:()=>ar});var ar=["version"];function lr(t){let{cldImage:e,options:r}=t,{version:i}=r;return(typeof i=="string"||typeof i=="number")&&e.setVersion(`${i}`.replace("v","")),{}}var gt={};P(gt,{plugin:()=>fr,props:()=>ur});var ur=["zoompan"];function fr(t){let{cldImage:e,options:r}=t,{zoompan:i=!1}=r,o={format:void 0};if(i===!0)e.effect("e_zoompan");else if(typeof i=="string")i==="loop"?(e.effect("e_zoompan"),e.effect("e_loop")):e.effect(`e_zoompan:${i}`);else if(typeof i=="object"){let a="e_zoompan";typeof i.options=="string"&&(a=`${a}${i.options}`),e.effect(a);let n;i.loop===!0?n="e_loop":typeof i.loop=="string"&&(n=`e_loop${i.loop}`),n&&e.effect(n)}return i!==!1&&(o.format="gif"),{options:o}}var be=[pt,st,at,ut,lt,ft,dt,mt,ht,gt,ct],Ee;function fe({options:t,config:e,analytics:r}){if(Ee||(Ee=new X(e)),!(t!=null&&t.src))throw Error("Failed to construct Cloudinary URL: Missing source (src) in options");let i={seoSuffix:void 0,version:void 0},o;if(t.src.startsWith("https://"))try{let n=ge(t.src);o=n==null?void 0:n.publicId,i.seoSuffix=n==null?void 0:n.seoSuffix,i.version=n==null?void 0:n.version}catch(n){}o||(o=t.src),Object.keys(i).forEach(n=>{b(t,n)||(t[n]=i[n])});let a=Ee.image(o);if(be.forEach(({plugin:n})=>{let l=n({cldImage:a,options:t}),{options:s}=l||{options:void 0};s!=null&&s.format&&t&&(t.format=s.format),s!=null&&s.width&&t&&(t.resize={width:s==null?void 0:s.width})}),t!=null&&t.resize){let{width:n,crop:l="scale"}=t.resize;a.effect(`c_${l},w_${n}`)}return a.setDeliveryType((t==null?void 0:t.deliveryType)||"upload").format((t==null?void 0:t.format)||"auto").delivery(`q_${(t==null?void 0:t.quality)||"auto"}`).toURL({trackedAnalytics:r})}async function Te(t){let{src:e}=t;try{await new Promise((r,i)=>{fetch(e).then(o=>{if(!o.ok){i(o);return}r(o)})})}catch(r){return r.status===423?await Te(t):!1}return!0}import pr from"next/package.json";var yt={name:"next-cloudinary",version:"3.4.0",main:"./dist/index.js",module:"./dist/index.mjs",types:"./dist/index.d.ts",source:"src/index.ts",scripts:{build:"tsup src/index.ts --dts",dev:"tsup src/index.ts --watch --dts",prepublishOnly:"cp ../README.md . && yarn build",postpublish:"rm ./README.md",test:"jest","test:app":'NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME="test" yarn build && cd tests/nextjs-app && yarn build'},dependencies:{"@cloudinary-util/url-loader":"^2.0.0","@cloudinary-util/util":"^2.0.0","@cloudinary/url-gen":"^1.8.6"},devDependencies:{"@babel/core":"^7.19.6","@babel/preset-env":"^7.19.4","@types/jest":"^29.2.0","@types/react":"^18.0.28","@types/react-dom":"^18.0.11","babel-jest":"^29.2.2",dotenv:"^16.0.3",jest:"^29.2.2","jest-environment-jsdom":"^29.2.2","ts-jest":"^29.0.3",tsup:"^6.6.3",typescript:"^4.9.4"},peerDependencies:{next:"^12 || ^13",react:"^17 || ^18"}};var ce="V",pe=yt.version,de=pr.version;function Ae({loaderOptions:t,imageProps:e,cldOptions:r,cldConfig:i={}}){let o={...e,...r};if(o.width=typeof o.width=="string"?parseInt(o.width):o.width,o.height=typeof o.height=="string"?parseInt(o.height):o.height,typeof(t==null?void 0:t.width)=="number"&&typeof o.width=="number"&&t.width!==o.width){let a=t.width/o.width;o.widthResize=t.width,typeof o.height=="number"&&(o.heightResize=Math.round(o.height*a))}return fe({options:o,config:{cloud:{cloudName:process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME},...i},analytics:{sdkCode:ce,sdkSemver:pe,techVersion:de,feature:""}})}var gr=t=>{let e=["deliveryType","preserveTransformations"];be.forEach(({props:s=[]})=>{s.forEach(f=>{if(e.includes(f))throw new Error(`Option ${f} already exists!`);e.push(f)})});let r={alt:t.alt,src:t.src};Object.keys(t).filter(s=>!e.includes(s)).forEach(s=>r[s]=t[s]);let i=Object.keys(r).map(s=>`${s}:${r[s]}`).join(";"),[o,a]=mr(i),n={};if(e.forEach(s=>{t[s]&&(n[s]=t[s]||void 0)}),t.preserveTransformations)try{let s=Le(t.src);n.rawTransformations=[...s.flat(),...t.rawTransformations||[]]}catch(s){console.warn(`Failed to preserve transformations: ${s.message}`)}async function l(s){await Te({src:s.target.src})&&a(`${i};${Date.now()}`)}return dr.createElement(hr,{key:o,...r,loader:s=>Ae({loaderOptions:s,imageProps:r,cldOptions:n}),onError:l})},_t=gr;import $ from"react";import yr from"next/head";var _r=2400,vr=1200,xr="summary_large_image",Cr=({excludeTags:t=[],twitterTitle:e,...r})=>{let i={...r,alt:r.alt,crop:r.crop||"fill",gravity:r.gravity||"center",height:r.height||vr,src:r.src,width:r.width||_r},o=fe({options:i,config:{cloud:{cloudName:process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME}},analytics:{sdkCode:ce,sdkSemver:pe,techVersion:de,feature:""}});return $.createElement(yr,null,$.createElement("meta",{property:"og:image",content:o}),$.createElement("meta",{property:"og:image:secure_url",content:o}),$.createElement("meta",{property:"og:image:width",content:`${i.width}`}),$.createElement("meta",{property:"og:image:height",content:`${i.height}`}),i.alt&&$.createElement("meta",{property:"og:image:alt",content:i.alt}),!t.includes("twitter:title")&&$.createElement("meta",{property:"twitter:title",content:e||" "}),$.createElement("meta",{property:"twitter:card",content:xr}),$.createElement("meta",{property:"twitter:image",content:o}))},vt=Cr;import he from"react";import Pe,{useState as Ct,useEffect as wt,useRef as Ot}from"react";import wr from"next/script";function xt(t){return window&&"requestIdleCallback"in window?requestIdleCallback(t):setTimeout(()=>t(),1)}var Or=["success","display-changed"],Er=({children:t,onClose:e,onError:r,onOpen:i,onUpload:o,options:a,signatureEndpoint:n,uploadPreset:l})=>{let s=Ot(),f=Ot(),d=!!n,[c,I]=Ct(void 0),[_,S]=Ct(void 0);wt(()=>{if(typeof _=="undefined")return;let u=_.event==="success",h=_.event==="display-changed"&&_.info==="hidden";u&&typeof o=="function"&&o(_,f.current),h&&typeof e=="function"&&e(f.current)},[_]),wt(()=>{c&&typeof r=="function"&&r(c,f.current)},[c]);function x(){s.current||(s.current=window.cloudinary),xt(()=>{f.current||(f.current=w())})}function E(u,h){if(typeof n=="undefined")throw Error("Failed to generate signature: signatureEndpoint undefined.");fetch(n,{method:"POST",body:JSON.stringify({paramsToSign:h})}).then(v=>v.json()).then(({signature:v})=>{u(v)})}function w(){var h;let u={cloudName:process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,uploadPreset:l||process.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET,apiKey:process.env.NEXT_PUBLIC_CLOUDINARY_API_KEY,...a};return d&&(u.uploadSignature=E,!u.apiKey)?new Error("Signed Upload needs apiKey!"):(h=s.current)==null?void 0:h.createUploadWidget(u,(v,p)=>{typeof v!="undefined"&&I(v),Or.includes(p==null?void 0:p.event)&&S(p)})}function m(){f.current||(f.current=w()),f==null||f.current.open(),typeof i=="function"&&i(f.current)}return Pe.createElement(Pe.Fragment,null,typeof t=="function"&&t({cloudinary:s.current,widget:f.current,open:m,results:_,error:c}),Pe.createElement(wr,{id:`cloudinary-uploadwidget-${Math.floor(Math.random()*100)}`,src:"https://widget.cloudinary.com/v2.0/global/all.js",onLoad:x,onError:u=>console.error(`Failed to load Cloudinary Upload Widget: ${u.message}`)}))},me=Er;var br=({children:t,onClick:e,onError:r,onUpload:i,options:o,signatureEndpoint:a,uploadPreset:n,...l})=>he.createElement(he.Fragment,null,he.createElement(me,{onError:r,onUpload:i,options:o,signatureEndpoint:a,uploadPreset:n},({open:s})=>{function f(d){d.preventDefault(),s(),typeof e=="function"&&e(d)}return he.createElement("button",{...l,onClick:f},t||"Upload")})),Et=br;import j,{useRef as Ie}from"react";import Tr from"next/script";import Ar from"next/head";var Pr=t=>{let{autoPlay:e="never",colors:r,controls:i=!0,fontFace:o,height:a,id:n,logo:l=!0,loop:s=!1,muted:f=!1,onDataLoad:d,onError:c,onMetadataLoad:I,onPause:_,onPlay:S,onEnded:x,src:E,version:w="1.9.4",width:m}=t,u=Ie(),h=Ie(),v=t.videoRef||h,p=Ie(),g=t.playerRef||p,O=n||`player-${E.replace("/","-")}`,y={error:c,loadeddata:d,loadedmetadata:I,pause:_,play:S,ended:x};function T(L){let B=y[L.type];typeof B=="function"&&B(M())}function Y(){if("cloudinary"in window){u.current=window.cloudinary;let L={};typeof l=="boolean"?L.showLogo=l:typeof l=="object"&&(L={...L,showLogo:!0,logoImageUrl:l.imageUrl,logoOnclickUrl:l.onClickUrl}),g.current=u.current.videoPlayer(v.current,{autoplayMode:e,cloud_name:process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME,color:r,controls:i,fontFace:o||"",loop:s,muted:f,publicId:E,secure:!0,...L}),Object.keys(y).forEach(B=>{var Se;typeof y[B]=="function"&&((Se=g.current)==null||Se.on(B,T))})}}function M(){return{player:g.current,video:v.current}}return j.createElement(j.Fragment,null,j.createElement(Ar,null,j.createElement("link",{href:`https://unpkg.com/cloudinary-video-player@${w}/dist/cld-video-player.min.css`,rel:"stylesheet"})),j.createElement("div",{style:{width:"100%",aspectRatio:`${t.width} / ${t.height}`}},j.createElement("video",{ref:v,id:O,className:"cld-video-player cld-fluid",width:m,height:a}),j.createElement(Tr,{id:`cloudinary-videoplayer-${Math.floor(Math.random()*100)}`,src:`https://unpkg.com/cloudinary-video-player@${w}/dist/cld-video-player.min.js`,onLoad:Y,onError:L=>console.error(`Failed to load Cloudinary Video Player: ${L.message}`)})))},bt=Pr;export{_t as CldImage,vt as CldOgImage,Et as CldUploadButton,me as CldUploadWidget,bt as CldVideoPlayer,Ae as cloudinaryLoader};
//# sourceMappingURL=index.mjs.map